<div class="card">
  <h2>Reportes</h2>
  <div class="grid">
    <div class="col-4">
      <label>Cliente</label>
      <select [(ngModel)]="clienteId" name="clienteId">
        <option [ngValue]="null">-- Seleccionar --</option>
        <option *ngFor="let c of clientes" [ngValue]="c.id">
          {{ c.nombre || c.nombreCompleto }} ({{ c.identificacion }})
        </option>
      </select>
    </div>
    <div class="col-3">
      <label>Desde</label><input type="date" [(ngModel)]="desde" name="desde" />
    </div>
    <div class="col-3">
      <label>Hasta</label><input type="date" [(ngModel)]="hasta" name="hasta" />
    </div>
    <div class="col-2" style="align-self: end">
      <button class="ok" (click)="ver()" [disabled]="!clienteId">Ver</button>
    </div>
    <div class="col-2" style="align-self: end">
      <button class="alt" (click)="descargar()" [disabled]="!clienteId">Descargar PDF</button>
    </div>
  </div>
  <div class="err" *ngIf="err">{{ err }}</div>
</div>

<div class="card" *ngIf="data">
  <h3 style="margin: 0 0 8px">Resumen</h3>
  <div class="grid">
    <div class="col-3">
      <b>Cliente:</b> {{ data.clienteNombre }}
    </div>
    <div class="col-3"><b>Rango:</b> {{ data.desde }} → {{ data.hasta }}</div>
    <div class="col-3"><b>Total Créditos:</b> {{ data.totalCreditos | number: '1.2-2' }}</div>
    <div class="col-3"><b>Total Débitos:</b> {{ data.totalDebitos | number: '1.2-2' }}</div>
  </div>

  <div style="margin-top: 14px">
    <h4 style="margin: 0 0 6px">Movimientos</h4>
    <table>
      <thead>
        <tr>
          <th>Fecha</th>
          <th>Cuenta</th>
          <th>Tipo</th>
          <th>Saldo Inicial</th>
          <th>Movimiento</th>
          <th>Saldo Final</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of data.items">
          <td>{{ item.fecha | date: 'yyyy-MM-dd HH:mm' }}</td>
          <td>{{ item.numeroCuenta }} ({{ item.tipoCuenta }})</td>
          <td>{{ item.movimiento > 0 ? 'CRÉDITO' : 'DÉBITO' }}</td>
          <td>{{ item.saldoInicial | number: '1.2-2' }}</td>
          <td>{{ item.movimiento | number: '1.2-2' }}</td>
          <td>{{ item.saldoDisponible | number: '1.2-2' }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
